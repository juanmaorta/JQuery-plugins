(function(F){var E,A=false,C=null,D=Math.random().toString().slice(10),B={init:function(G){E=F.extend({animate:true,callback_show:null,callback_hide:null,bg_opacity:0.6,bg_class:"bgtransparent",id:"bgtransparent",delay:150,closeOnEsc:true},G||{});return this},show:function(){if(!A){C=this;A=true;var H=F("<div>").attr({className:E.bg_class,id:E.id}),I=F(window).width(),J=F(window).height(),K=0,G=0;F("body").append(H);H.css("width",I);H.css("height",J);if(E.animate){H.animate({opacity:E.bg_opacity},E.delay)}else{H.css("opacity",E.bg_opacity)}K=parseInt(I,10)/2-parseInt(this.width(),10)/2;G=parseInt(J,10)/2-parseInt(this.height(),10)/2+parseInt(F(window).scrollTop(),10);this.css("left",K+"px");this.css("top",G+"px");this.css("opacity",0);this.css("visibility","visible");this.css("display","block");if(E.animate){this.animate({opacity:1},E.delay,function(){if(E.callback_show!==null){E.callback_show.apply()}})}else{this.css("opacity",1);if(E.callback_show!==null){E.callback_show.apply()}}if(E.closeOnEsc){F(document).bind("keydown."+D,function(L){if(L.keyCode===27){C.overlay("close")}})}}else{B.close.apply()}},close:function(){if(A){this.hide();if(E.animate){F("#"+E.id).animate({opacity:0},E.delay,function(){F(this).remove();if(E.callback_hide!==null){E.callback_hide.apply()}})}else{F("#"+E.id).remove();if(E.callback_hide!==null){E.callback_hide.apply()}}A=false;if(E.closeOnEsc){F(document).unbind("keydown."+D)}}else{B.show.apply()}}};F.fn.overlay=function(G){if(B[G]){return B[G].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof G==="object"||!G){B.init.apply(this,arguments);return B.show.apply(this,arguments)}else{F.error("Method "+G+" does not exist on jQuery.overlay")}}return this}}(jQuery))